#include <iostream>
#include <string>
#include <cstdlib>
#include <ctime>
using namespace std;

void quest3() {
    int playerHealth = 100;

    // LEVEL 1
    cout << "QUEST 3: HOVE DESERT" << endl;
    cout << " LEVEL 1:" << endl;
    cout << "* Ah, very hot weather, looks like this will be challenging *" << endl;
    cout << "PROMPT: We need to find some water first to avoid dehydration " << endl;
    cout << "* AHH! What was that? *" << endl;
    cout << "PROMPT: A snake has bitten your leg " << endl;
    cout << "* I need to find a cure*" << endl;
    cout << "* There's a desert herb nearby, let's see if I can find something there*" << endl;
    cout << "PROMPT: Time to solve a problem to successfully extract the cure and apply it " << endl;
    cout << "PROMPT: Unjumble the following word: ";
    cout << "[AEDOLIR]" << endl;
    cout << "* What can it be? *" << endl;

    string cureAnswer;
    for (int attempts = 3; attempts > 0; --attempts) {
        cout << "Enter your answer (" << attempts << " attempts remaining): ";
        getline(cin, cureAnswer);

        if (cureAnswer == "ELDORIA") {
            cout << "You did that correctly! Cure successfully applied, health replenishment ++" << endl;
            break;
        } else {
            cout << "Incorrect answer. Try again." << endl;
            playerHealth -= 40;
            cout << "Your health is " << playerHealth << endl;
        }
    }

    if (playerHealth <= 0)
     {
        cout << "Incorrect 3x! THE SNAKE VENOM GOT YOU! GAME OVER!" << endl;
        return;
    }

    // LEVEL 2
    cout << " LEVEL 2:" << endl;
    cout << "* The dehydration is getting me again *" << endl;
    cout << " PROMPT: HEALTH --" << endl;
    cout << "* I can't sustain desert heat for long, need to find some water*" << endl;
    cout << "PROMPT: Travelling in search of water " << endl;
    cout << "* I hope I make it *" << endl;
    cout << "* Is that a well right there? Don't give me hope! *" << endl;
    cout << "* Let's reach there before my health gets worse *" << endl;
    cout << "HEALTH --" << endl;
    cout << "* Almost there*" << endl;
    cout << "* Let's fetch some water: *" << endl;
    cout << "PROMPT: Solve a riddle to get some water: " << endl;
    cout << "Feed me and I live. Give me a drink and I die. What am I?" << endl;

    cout << "ONLY 1 ATTEMPT !" << endl;

    string waterAnswer;
    cout << "Enter your answer: "<<endl;
    cin>>waterAnswer;

    if (waterAnswer =="Fire"|| waterAnswer =="FIRE"|| waterAnswer =="fire") 
    {
        cout << "Correct! HEALTH++" << endl;
        playerHealth += 50;
    } 
    
    else {
        cout << "Incorrect! Game over!" << endl;
        return;
    }

    // LEVEL 3
    cout << "LEVEL 3:" << endl;
    cout << "* Feeling better now, hydrated at last! *" << endl;
    cout << "* Continuing the journey to discover the truth*" << endl;
    cout << "* What's that creature right there; I hope it's harmless? *" << endl;
    cout << "* Let's see if it leads somewhere? *" << endl;

    cout << "PROMPT: Following the unknown animal, looks like a large bird" << endl;

    cout << "* Creature: [SCREECH !!! GHHHHHHHHH !! KERRRRRRRRRR! ]" << endl;
    cout << "* Is that an eagle? Is that a lion? *" << endl;

    cout << "OH NO! That's a griffin*" << endl;

    cout << "PROMPT: DEFEAT THE BEAST:" << endl;

    int griffinHealth = 60;

    cout << "You encountered a Griffin! Get ready for battle." << endl;

    while (true) {
        cout << "Griffin Health: " << max(0, griffinHealth) << endl;
        cout << "Your Health: " << max(0, playerHealth) << endl;
        cout << "Press '1' to attack: ";

        // Player Attack
        char choice;
        cin >> choice;

        if (choice == '1') {
            int playerAttack = rand() % 11 + 1;
            griffinHealth -= playerAttack;
            cout << "You attacked the Griffin with " << playerAttack << " damage!" << endl;

            if (griffinHealth <= 0) {
                cout << "You defeated the Griffin! Victory!" << endl;
                break;
            }

            // Griffin Attack
            int griffinAttack = rand() % 11 + 1;
            playerHealth -= griffinAttack;

            cout << "The Griffin attacked you with " << max(0, griffinAttack) << " damage!" << endl;

            if (playerHealth <= 0) {
                cout << "You were defeated by the Griffin. Game Over!" << endl;
                return;
            }
        } else {
            cout << "Invalid input. Try again." << endl;
            cin.clear();
            cin.ignore('\n');
        }
    }

    cout << "* Ahh! That was a close one; I wonder what could have happened *" << endl;
    // cout << "[MYSTERY STONES ADDED TO INVENTORY]" << endl;
    //cout << "These stones better give access to the lost lands as the legends stated." << endl;
    
}

int main() {
    quest3();
    return 0;
}
